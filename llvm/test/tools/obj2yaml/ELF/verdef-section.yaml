## Check how we dump SHT_GNU_verdef sections.
## Check we don't dump the `Info` field when its value is equal
## to the number of version definitions.

# RUN: yaml2obj %s -o %t
# RUN: obj2yaml %t | FileCheck %s

# CHECK:       - Name:         .gnu.version_d
# CHECK-NEXT:    Type:         SHT_GNU_verdef
# CHECK-NEXT:    Flags:        [ SHF_ALLOC ]
# CHECK-NEXT:    Address:      0x230
# CHECK-NEXT:    Link:         .dynstr
# CHECK-NEXT:    AddressAlign: 0x4
# INFO-NEXT:     Info:         0x4
# CHECK-NEXT:    Entries:
# CHECK-NEXT:      - Names:
# CHECK-NEXT:          - VERSION_0
# CHECK-NEXT:      - Flags:      2
# CHECK-NEXT:        VersionNdx: 2
# CHECK-NEXT:        Hash:       108387921
# CHECK-NEXT:        Names:
# CHECK-NEXT:          - VERSION_1
# CHECK-NEXT:      - Flags:      3
# CHECK-NEXT:        VersionNdx: 3
# CHECK-NEXT:        Hash:       108387922
# CHECK-NEXT:        Names:
# CHECK-NEXT:          - VERSION_2
# CHECK-NEXT:          - VERSION_3
# CHECK-NEXT:          - VERSION_4
# CHECK-NEXT:  - Name:

--- !ELF
FileHeader:
  Class: ELFCLASS64
  Data:  ELFDATA2LSB
  Type:  ET_DYN
Sections:
  - Name:            .gnu.version_d
    Type:            SHT_GNU_verdef
    Flags:           [ SHF_ALLOC ]
    Address:         0x230
    AddressAlign:    0x4
    Info:            [[INFO=<none>]]
    Entries:
## An entry that has all fields explicitly set to their default values.
## Used to check that we don't dump them.
      - Version:    [[VERSION=1]]
        Flags:      0
        VersionNdx: 0
        Hash:       0
        Names:
          - V0
          - V1
## Needed to emit the .dynstr section.
DynamicSymbols: []
